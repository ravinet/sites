PHTTP54.240.190.29"ç
,GET /psp/bestbuy-v1-001/247px.js? HTTP/1.1
%Host: d1af033869koo7.cloudfront.net
Connection: keep-alive
Accept: */*
vUser-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36
"Referer: http://www.bestbuy.com/
$Accept-Encoding: gzip,deflate,sdch
!Accept-Language: en-US,en;q=0.8

*ø…
HTTP/1.1 200 OK
(Content-Type: application/x-javascript
Content-Length: 33006
Connection: keep-alive
%Date: Fri, 03 Jan 2014 10:22:01 GMT
%Cache-Control: max-age=7200, public
.Last-Modified: Fri, 03 Jan 2014 10:17:18 GMT
*ETag: "abc16f0b21bad867f4ef355df9edaaa1"
Accept-Ranges: bytes
Server: AmazonS3

Age: 251
X-Cache: Hit from cloudfront
GVia: 1.1 cf68ab3183d40f840b0528b2cae23a4c.cloudfront.net (CloudFront)
GX-Amz-Cf-Id: Yj_E2-yZCbxLZftqLYn5rt5XRZ516yC_Uqe1ntC-3UbO_wKuaUoqcg==
ð
if(typeof SN==="undefined"){SN={}}SN.Conf=(function(){function b(c){return c}function a(){return"id"}return{CONST_PSP_KEY:"bestbuy-v1-001",CUSTOM_TRACK_SERVER:"bestbuycdn.px.247inc.net",DOMAIN_VS_PARAMETIZED_PATH_AND_EXTENSION:{"www.bestbuy.com":"/247/247SN.html","bestbuy.com":"/247/247SN.html","www-ssl.bestbuy.com":"/247/247SN.html","espanol.bestbuy.com":"/247/247SN.html","espanol-ssl.bestbuy.com":"/ssl/247/247SN.html","bby-qa3.bestbuy.com":"/247/247SN.html"},CONST_PXFWK_ID:"pxfwk.gz.js",CONST_CDN_VERSION:"v1.29",CONST_PSP_VERSION:"default",COOKIEPATH:["www.bestbuy.com","www-ssl.bestbuy.com","espanol.bestbuy.com","espanol-ssl.bestbuy.com","www.cdc-172-16-22-151.cdc.bestbuy.com","espanol.cdc-172-16-22-151.cdc.bestbuy.com"],INVALID_COOKIE_CHARACTERS:["&",">","<","#",";","javascript:","\x00","script","ATTACK","REPLACE","STYLE","%2F","ALERT","TRACE","X_IGNORE","X-NADA:","GET","\x7F","%3C",")","(","%3E","APPEND"],PSP_ROOT:"bestbuypsp.px.247inc.net",PSP_VERSION:"default",CDN_PATH:"d1af033869koo7.cloudfront.net/psp/",PXOE_VERSION:"5.3.4",TRACKING_VERSION:"1.3",getDecodedValue:b,IS_DS_REQUIRED:false,getUrlId:a,CONST_PSP_ROOT:"bestbuypsp.px.247inc.net",CONST_PSP_CDN_ROOT:"d1af033869koo7.cloudfront.net",CONST_PSP_STAGE:"p",CONST_PSP_CLIENT_KEY:"bestbuy-v1-001",pspxdPath:"/pspxd.html",CONST_PSP_VISITOR_PERCENTAGE:100,PROXY_SERVER:"psp.247ilabs.com/tps/tpsp.php?",pollingTime:10000,varmap:{Ipchatvar:"true"},trackingUrlFlag:false,varMapFlag:false,FSM:{currentPageUrl:"document.location.href",referrer:"parent.document.referrer",title:"parent.document.title",el:'SN.Conf.getDecodedValue(SN.CookieManager.readSNCookie("sn.eh","el"))'},ED:{},TEST_PERCENTAGE:0,BYPASS_PERCENTAGE:0,SPACER_IMAGEPATH:"bestbuypsp.px.247inc.net/",MAX_COOKIE_SIZE:2000,CONST_TENANT_ID:"nemo-client-bestbuy",MAX_COOKIE_COUNT_THRESHOLD:50,MIN_COOKIE_COUNT_THRESHOLD:45,DISABLED_COOKIES:[]}}());if(typeof SN==="undefined"){SN={}}SN.Constants=(function(){var a={UNDEFINED_STR:"undefined",LOGLEVEL_ERROR:"e",LOGLEVEL_WARN:"w",LOGLEVEL_DEBUG:"d",LOGLEVEL_INFO:"i",SN_BS_COOKIE_NAME:"sn.bs",SN_AS_COOKIE_NAME:"sn.as",SN_UI_COOKIE_NAME:"sn.ui",SN_VI_COOKIE_NAME:"sn.vi",SN_RN_COOKIE_NAME:"sn.rn",SN_EXIT_HISTORY_COOKIE_NAME:"sn.eh",SN_VARIABLE_COOKIE_NAME:"sn.vc",SN_WEBTRACKER_COOKIE_NAME:"sn.wt",SN_VISITOR_COOKIE_NAME:"sn.vi",IS_ENV_SUPPORTED_OR_NOT:"es",IS_CUSTOM_TRACKING_ENABLED:"cte",KEY_VALUE_SEPERATOR:"||",KEY_VALUE_SEPERATOR_OLD:"#",KEY_SEPERATOR:"~"};return a}());SN.Utils=(function(){function a(c){return((c=="undefined")||(c==null)||(c==="null"))}var b={undefinedOrNull:a};return b}());SN.Logger=(function(){var d=SN.Constants;var a=false;function c(e){if(!a){return}if(typeof console!=d.UNDEFINED_STR){console.log(e)}}var b={consoleLog:c};return b}());SN.UserAgentParser=(function(){var m=navigator.userAgent;var u="unknown";var c=u;var g="~";var a="others";var j="U";var d=u;var e=u;var v=SN.Logger;var p={Win:{osType:"Windows",osVersion:{"NT 5.1":"XP","NT 6.0":"Vista","NT 6.1":"7","NT 6.2":"8"}},Mac:{osType:"MacOS",osVersion:{"Mac OS X 10_4":"Tiger","Mac OS X 10.4":"Tiger","Mac OS X 10_5":"Leopard","Mac OS X 10.5":"Leopard","Mac OS X 10_6":"Snow Leopard","Mac OS X 10.6":"Snow Leopard"}},Linux:{osType:"Linux",osVersion:{Ubuntu:"Ubuntu",CentOS:"CentOS","Red Hat":"Red Hat",Mandriva:"Mandriva",Gentoo:"Gentoo",Debian:"Debian",Fedora:"Fedora"}}};function r(z){if(z!=null){var x=m.split(z);var y=/(\d+\.)+\d+/;var w=y.exec(x[1]);return w[0]}}var o={Firefox:{lowestSupportedVersion:"3.6",blacklistedVersions:[],getVersion:function(){return r("Firefox/")}},Version:{lowestSupportedVersion:"5",blacklistedVersions:[],getVersion:function(){return r("Version/")}},Chrome:{lowestSupportedVersion:"10",blacklistedVersions:[],getVersion:function(){return r("Chrome/")}},MSIE:{lowestSupportedVersion:"7",blacklistedVersions:[],getVersion:function(){var y=/MSIE (\d+\.)+\d+/;var x=y.exec(m);var w=x[0].split(" ");return w[1]}}};var q={Tablet:{1:["android","!mobile"],2:["ipad","webkit"],3:["playbook"],4:["kindle"],5:["xoom"],6:["tablet"]},Mobile:{1:["iphone","!ipad","!ipod"],2:["blackberry"],3:["android","mobile"],4:["iemobile"],5:["windows phone"],6:["nokia"],7:["fennec"],8:["mib"],9:["minimo"],10:["symbian"],11:["netfront"],12:["up.browser"],13:["openweb"],14:["opera mini"],15:["opera mobi"],16:["brew"],17:["danger"],18:["hiptop"],19:["midp"],20:["webos"]},Desktop:{1:["windows"],2:["linux"],3:["oss+[x9]"],4:["solaris"],5:["bsd"]},Unknown:{1:["others"]}};function i(w){if(w=="Version"){if((m.indexOf("Opera")==-1)&&(m.indexOf("Safari")!=-1)){return(m.indexOf(w)!=-1)}else{return false}}return(m.indexOf(w)!=-1)}function b(){return d}function k(){return d+g+j+g+a}function l(){for(var w in o){if(i(w)==true){c=w.toLowerCase().charAt(0);if(c=="v"){c="s"}else{if(c=="m"){c="i"}}c=c+g+o[w].getVersion()}}}function f(){return(window.navigator.language)?window.navigator.language:window.navigator.userLanguage}function n(){return c}function h(){for(var A in p){if(m.indexOf(A)!=-1){var z=p[A].osVersion;d=p[A].osType;for(var x in z){if(m.indexOf(x)!=-1){e=z[x]}}}}if(d==u){var y="Android";var w=-1;if((w=m.indexOf(y))!=-1){d=y;e=m.substring(w+8,w+11)}else{if(m.indexOf("X11")!=-1){d="UNIX"}}}if(e!=u){d=d+"-"+e}}function t(){try{var y=m.toLowerCase();var w=0;for(var D in q){if(w==1){break}else{var C=q[D];for(var B in C){w=1;for(var x in C[B]){var z=C[B][x];if(z.charAt(0)=="!"){if(y.indexOf(z.substring(1))!=-1){w=0;break}}else{if(y.indexOf(z)==-1){w=0;break}}}if(w==1){j=D.charAt(0);a=C[B]["0"];break}}}}}catch(A){v.consoleLog("Error while initializing device details:",A)}}var s={getOSType:b,browserList:o,isBrowser:i,getBrowserDetails:n,getBrowserLanguage:f,getDeviceDetails:k};h();t();l();return s})();if(typeof SN==="undefined"){SN={}}SN.loadTrackingScript=function(i,l,f,k,m,c){var g=SN.Constants;try{var h=new String(new Date().getTime());var e=document.createElement("script");e.type="text/javascript";var b="id="+window.pspSNTrackingId+"&type="+i+"&ts="+h;if(typeof l!==g.UNDEFINED_STR&&l!=null){b=b+"&vid="+l}var a=window.location.pathname;if(a.length>200){a=a.substr(0,200)}b=b+"&u="+a;b=b+"&ll="+c;if(typeof f!==g.UNDEFINED_STR&&f!=null&&f!=""){b=b+"&ed="+f}if(b.length>2000){b=b.substr(0,2000)}e.id="track-js"+h;e.src=document.location.protocol+"//"+k+"/psp/"+m+"/"+SN.Conf.CONST_PSP_VERSION+"/cpxt.js?"+b;var j=document.getElementsByTagName("head").item(0);void (j.appendChild(e))}catch(d){if(typeof console!=undefined){SN.Logger.consoleLog("Error while sending custom tracking data "+d)}}};var JSON_247=(function(){var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}function stringify(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON_247.stringify")}return str("",{"":value})}function parse(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON_247.parse")}var me={parse:parse,stringify:stringify};return me})();SN.Logger=(function(){var d=SN.Constants;var a=false;function c(e){if(!a){return}if(typeof console!=d.UNDEFINED_STR){console.log(e)}}var b={consoleLog:c};return b}());SN.CookieSanitizer=(function(){var d=SN.Conf.INVALID_COOKIE_CHARACTERS;var c=d.length;function a(g){if(typeof g!="string"){return g}var f=g;for(var e=0;e<c;++e){f=f.split(d[e]).join("")}if(f!=g){SN.loadTrackingScript("InvalidCharacterInCookie","","",SN.Conf.CUSTOM_TRACK_SERVER,SN.Conf.CONST_PSP_KEY,SN.Constants.LOGLEVEL_ERROR)}return f}var b={sanitize:a};return b}());SN.CookieManager=(function(){var h=SN.Constants;var a="~";var i="||";var n="p";var l="sn.wt";function b(v,p){var q=unescape(g(v));if(p==null){return q}if(q==null){return null}var s=q.split(a);var u=p+i;for(var o=0;o<s.length;o++){var t=s[o];if(t.indexOf(u)==0){var r=t.substring(u.length,t.length);return r}}return null}function c(u,s){try{var t=g(u);var q=true;if(typeof t=="undefined"||t==null){t=""}else{q=false}var o="";var x=new Object();for(var v in s){if(q){q=false}else{o+=a}o+=(v+i+s[v])}t=t+o;j(u);if(SN.Conf.COOKIEPATH!=null&&SN.Conf.COOKIEPATH.length>0){for(var r=0;r<SN.Conf.COOKIEPATH.length;r++){var w="."+SN.Conf.COOKIEPATH[r];if(document.domain==SN.Conf.COOKIEPATH[r]||d(document.domain,w)){x.domain=w}}}if((typeof x.domain=="undefined"||x.domain==null)&&SN.Conf.COOKIEPATH!=null&&SN.Conf.COOKIEPATH.length>0){for(var r=0;r<SN.Conf.COOKIEPATH.length;r++){var w="."+SN.Conf.COOKIEPATH[r];if(document.location.href.replace(/https?:\/\//,"").indexOf(SN.Conf.COOKIEPATH[r])==0){x.domain=w}}}if(typeof x.domain==undefined||x.domain==null){x.domain="."+document.domain}f(u,t,x)}catch(p){SN.Logger.consoleLog("Error while creating SNCookie : "+p)}}function m(y,B,A,z){var t="";var C="";var p=false;var u=true;var x=g(y);if(x==null){x=""}var w=x.split(a);var r=B+i;for(var s=0;s<w.length;s++){var q=w[s];if(q==""){continue}if(q.indexOf(r)==0){p=true}else{if(p){C=C+a+q}else{if(u){t=q;u=false}else{t=t+a+q}}}}var o="";if(A==null){o=t+C}else{if(t==""){o=r+A+C}else{o=t+a+r+A+C}}var E={};if(!SN.Utils.undefinedOrNull(z)){E.time=z}if(SN.Conf.COOKIEPATH!=null&&SN.Conf.COOKIEPATH.length>0){for(var v=0;v<SN.Conf.COOKIEPATH.length;v++){var D="."+SN.Conf.COOKIEPATH[v];if(document.domain==SN.Conf.COOKIEPATH[v]||d(document.domain,D)){E.domain=D}}}if(SN.Utils.undefinedOrNull(E.domain)&&SN.Conf.COOKIEPATH!=null&&SN.Conf.COOKIEPATH.length>0){for(var v=0;v<SN.Conf.COOKIEPATH.length;v++){var D="."+SN.Conf.COOKIEPATH[v];if(document.location.href.replace(/https?:\/\//,"").indexOf(SN.Conf.COOKIEPATH[v])==0){E.domain=D}}}if(SN.Utils.undefinedOrNull(E.domain)){E.domain="."+document.domain}f(y,o,E)}function f(r,s,q){if(q==null){q={}}var o=[];s=SN.CookieSanitizer.sanitize(s);o.push(k(r,s));if(!(q.time==null)){var p=new Date();p.setTime(p.getTime()+q.time);o.push(k("expires",p.toGMTString()))}if(q.path==null){q.path="/"}o.push(k("path",q.path));if(!(q.domain==null)){o.push(k("domain",q.domain))}document.cookie=o.join("; ")}function g(){var r=[];var s="";for(var p=0;p<arguments.length;p++){r[p]=arguments[p]+"="}var o=document.cookie.split(";");for(var q=0;q<o.length;q++){var t=o[q];while(t.charAt(0)==" "){t=t.substring(1,t.length)}for(p=0;p<r.length;p++){if(t.indexOf(r[p])==0){s+=t.substring(r[p].length,t.length)}}}return s}function d(p,o){var q=p.indexOf(o);if(q>=0&&q+o.length==p.length){return true}return false}function k(p,q){var o=[];o.push(p);o.push("=");o.push(q);return o.join("")}function j(p){var o={};o.time=-(24*60*60*1000);o.domain="."+document.domain;f(p,"",o)}function e(){var o=b(l,n);return o}return{createSNCookie:m,readSNCookie:b,readCookie:g,eraseCookie:j,createSNCookieForMap:c,getUrlVisitSeq:e,createCookie:f}}());(function checkForViCookie(){var b=SN.Constants;var a=document.cookie;if((a.indexOf(b.SN_VI_COOKIE_NAME)==-1)&&((a.indexOf(b.SN_BS_COOKIE_NAME)!=-1)||(a.indexOf(b.SN_AS_COOKIE_NAME)!=-1)||(a.indexOf(b.SN_RN_COOKIE_NAME)!=-1)||(a.indexOf(b.SN_WEBTRACKER_COOKIE_NAME)!=-1))){if(SN.CookieManager.readSNCookie(b.SN_BS_COOKIE_NAME,"d")=="a"){SN.CookieManager.eraseCookie(b.SN_BS_COOKIE_NAME);SN.CookieManager.eraseCookie(b.SN_AS_COOKIE_NAME);SN.CookieManager.eraseCookie(b.SN_RN_COOKIE_NAME);SN.CookieManager.eraseCookie(b.SN_UI_COOKIE_NAME);SN.CookieManager.eraseCookie(b.SN_WEBTRACKER_COOKIE_NAME);SN.CookieManager.eraseCookie(b.SN_EXIT_HISTORY_COOKIE_NAME);SN.CookieManager.eraseCookie(b.SN_VARIABLE_COOKIE_NAME);SN.loadTrackingScript("DataCleanedSinceViCookieExpired","","",SN.Conf.CUSTOM_TRACK_SERVER,SN.Conf.CONST_PSP_KEY,b.LOGLEVEL_INFO)}}})();(function replaceHashInCookies(){var d=SN.Constants;var b=[d.SN_BS_COOKIE_NAME,d.SN_AS_COOKIE_NAME,d.SN_RN_COOKIE_NAME,d.SN_UI_COOKIE_NAME,d.SN_WEBTRACKER_COOKIE_NAME,d.SN_EXIT_HISTORY_COOKIE_NAME,d.SN_VARIABLE_COOKIE_NAME,d.SN_VISITOR_COOKIE_NAME];for(var c=0;c<b.length;c++){var a=SN.CookieManager.readCookie(b[c]);if(!SN.Utils.undefinedOrNull(a)&&a.search(d.KEY_VALUE_SEPERATOR_OLD)>=0){a=a.replace(/#/g,"||");SN.CookieManager.eraseCookie(b[c]);options={};options.time=86400000;options.domain="."+document.domain;SN.CookieManager.createCookie(b[c],a,options)}}})();SN.Tracker=(function(){var SN_CONSTANTS=SN.Constants;var uAParser=SN.UserAgentParser;var fsmMap=SN.Conf.FSM;var ed=SN.Conf.ED;var CONST_REQUEST_ID="r";var CONST_TRACKING_DATA="d";var CONST_IE="MSIE";var CONST_SAFARI="Safari";var CONST_RETRY_COUNT="retryCount";var CONST_REQUEST_TIME="requestTime";var CONST_REQUEST_PARAM="requestParam";var CONST_TRACKING_SECURED="trackingSecured";var eventStorage={};var pspVersion=SN.Conf.CONST_PSP_VERSION;var CONST_POLLING_TIME_INTERVAL=3000;var MAX_RETRY_COUNT=3;var CONST_TIME_OUT=2000;var tseq=-1;var sseq=-1;var uniquePageId=new Date().getTime();var vi;var bsid;var MAX_URL_SIZE;var statusTracker;var status={};var vg;var tp;var ti;var rt;var rv;function poll(){sendAll()}function saveOnExit(arg){try{var jsonEventStorage=JSON_247.stringify(eventStorage);sessionStorage.setItem("sn.tdata",jsonEventStorage)}catch(err){SN.Logger.consoleLog("SN.Tracker:Error storing event data "+err)}}function init(){if(isIE()||isSafari()){MAX_URL_SIZE=1000;SN.Logger.consoleLog("SN.Tracker: browser type IE , setting url size to 2k")}else{MAX_URL_SIZE=1700;SN.Logger.consoleLog("SN.Tracker: browser type is not IE , setting url size to 4k")}setInterval(poll,CONST_POLLING_TIME_INTERVAL);if((typeof sessionStorage==SN_CONSTANTS.UNDEFINED_STR)||(SN.Utils.undefinedOrNull(sessionStorage))){return}try{if(window.addEventListener){window.addEventListener("unload",saveOnExit,false)}else{if(document.addEventListener){document.addEventListener("unload",saveOnExit,false)}else{if(window.attachEvent){window.attachEvent("onunload",saveOnExit)}}}var oldEventData=eval("("+sessionStorage.getItem("sn.tdata")+")");copyParams(oldEventData,eventStorage);sendAll()}catch(err){SN.Logger.consoleLog("SN.Tracker:Error in accessing old session data "+err)}}function sendAll(){for(var source_reqId in eventStorage){var requestObj=eventStorage[source_reqId];var trackingSecured;if(requestObj[CONST_RETRY_COUNT]<MAX_RETRY_COUNT){if((new Date().getTime())-requestObj[CONST_REQUEST_TIME]>CONST_TIME_OUT){requestObj[CONST_REQUEST_TIME]=new Date().getTime();requestObj[CONST_RETRY_COUNT]=requestObj[CONST_RETRY_COUNT]+1;SN.Logger.consoleLog("SN.Tracker:Retrying It, retry count ="+requestObj[CONST_RETRY_COUNT]+", request id ="+source_reqId);trackingSecured=requestObj[CONST_TRACKING_SECURED];makeTrackingCall(getDefaultUrl(trackingSecured),requestObj[CONST_REQUEST_PARAM])}}else{SN.Logger.consoleLog("SN.Tracker:Removing event data , retry count ="+requestObj[CONST_RETRY_COUNT]+", request id :"+source_reqId);delete eventStorage[source_reqId];updateStatus(source_reqId,"FAILED")}}}function makeTrackingCall(url,params){sseq++;var scriptId="pt"+sseq;var head=document.getElementsByTagName("head").item(0);var pspTrack=document.createElement("script");pspTrack.type="text/javascript";pspTrack.id=scriptId;pspTrack.src=appendUrlParams(url,scriptId,params);pspTrack.async=true;void (head.appendChild(pspTrack))}function processResponse(res){SN.Logger.consoleLog("SN.Tracker: Processing response");if(!SN.Utils.undefinedOrNull(res.code)){SN.Logger.consoleLog("SN.Tracker: Got error response for r="+res.r+" with error code= "+res.code);if(!SN.Utils.undefinedOrNull(eventStorage[res.r])){delete eventStorage[res.r];updateStatus(res.r,"FAILED")}}if(!SN.Utils.undefinedOrNull(eventStorage[res.r])){SN.Logger.consoleLog("SN.Tracker: Got success response for req ="+res.r+" ,  removing it");delete eventStorage[res.r];updateStatus(res.r)}else{SN.Logger.consoleLog("SN.Tracker: Got success response for req ="+res.r+" , but the response is already processed , so ignoring it")}}function removeElement(oldId){var old=document.getElementById(oldId);if(old){var head=document.getElementsByTagName("head").item(0);setTimeout(function(){try{head.removeChild(old)}catch(err){SN.Logger.consoleLog("Could not remove pxt.js in 247px.js. "+err)}},2000)}}function getSessionData(){var activeSessionId;var activeSessionPresent;var sessionData={};if(SN.Utils.undefinedOrNull(vi)){vi=SN.CookieManager.readSNCookie(SN_CONSTANTS.SN_VI_COOKIE_NAME,"vi")}sessionData.vi=vi;var scope=SN.CookieManager.readSNCookie(SN_CONSTANTS.SN_VI_COOKIE_NAME,"sp");var cookieName=SN_CONSTANTS.SN_AS_COOKIE_NAME;if(scope=="bs"){cookieName=SN_CONSTANTS.SN_BS_COOKIE_NAME}if(SN.Utils.undefinedOrNull(vg)||SN.Utils.undefinedOrNull(tp)||SN.Utils.undefinedOrNull(ti)||SN.Utils.undefinedOrNull(rt)||SN.Utils.undefinedOrNull(rv)){vg=SN.CookieManager.readSNCookie(cookieName,"vg");ti=SN.CookieManager.readSNCookie(cookieName,"ti");tp=SN.CookieManager.readSNCookie(cookieName,"tp");rt=SN.CookieManager.readSNCookie(SN_CONSTANTS.SN_RN_COOKIE_NAME,"rt");rv=SN.CookieManager.readSNCookie(SN_CONSTANTS.SN_RN_COOKIE_NAME,"rv")}sessionData.vg=vg;sessionData.ti=ti;sessionData.tp=tp;sessionData.rt=rt;sessionData.rv=rv;activeSessionPresent=SN.CookieManager.readSNCookie(SN_CONSTANTS.SN_AS_COOKIE_NAME,"a");activeSessionId=SN.CookieManager.readSNCookie(SN_CONSTANTS.SN_VI_COOKIE_NAME,"as");if(!SN.Utils.undefinedOrNull(activeSessionId)){if(!(activeSessionPresent=="t")){sessionData.as=(parseInt(activeSessionId)+1).toString()}else{sessionData.as=activeSessionId}}sessionData.v=SN.Conf.CONST_PSP_VERSION;if(SN.Utils.undefinedOrNull(bsid)){bsid=getBSID()}sessionData.bsid=bsid;sessionData.up=getUniquePageId();var liots=SN.CookieManager.readSNCookie(SN_CONSTANTS.SN_VI_COOKIE_NAME,"it");if(liots==null){liots=0}sessionData.it=liots;tseq++;sessionData.tseq=tseq;return sessionData}function createMetaData(){var metadata={};metadata.key=SN.Conf.CONST_PSP_KEY;return metadata}function constructAndMakeTrackingCall(metaData,eventData,callBack,trackingSecured){if(!SN.Utils.undefinedOrNull(callBack)){statusTracker=callBack}if(SN.Utils.undefinedOrNull(metaData)){metaData=createMetaData()}var url=getDefaultUrl(trackingSecured);var sessionData=getSessionData();eventData.vp=SN.Conf.PXOE_VERSION;eventData.vt=SN.Conf.TRACKING_VERSION;eventData.tnt=SN.Conf.CONST_TENANT_ID;copyParams(sessionData,eventData);if(SN.Utils.undefinedOrNull(eventData.f)){eventData.f={}}if(SN.Utils.undefinedOrNull(eventData.f.v)){eventData.f.v={}}eventData.f.v.br=uAParser.getBrowserDetails();eventData.f.v.dd=uAParser.getDeviceDetails();currDate=new Date();eventData.f.v.tz=currDate.getTimezoneOffset();var requestId=getUniqueId();var trackingDatas=createTrackingData(eventData);var noOfTrackingDataParts=trackingDatas.length;status[requestId]=noOfTrackingDataParts;var sequenceId=1;while(trackingDatas.length>0){var requestParam={};requestParam[CONST_REQUEST_ID]=requestId+"-"+noOfTrackingDataParts+"-"+sequenceId;sequenceId++;try{copyParams(metaData,requestParam);requestParam[CONST_TRACKING_DATA]=trackingDatas.shift();save(requestParam,trackingSecured);SN.Logger.consoleLog("SN.Tracker: Got an event, assigning request id = "+requestParam[CONST_REQUEST_ID]);makeTrackingCall(url,requestParam)}catch(err){SN.Logger.consoleLog("SN.Tracker:Exception while sending event data. request id:"+requestParam[CONST_REQUEST_ID]+" "+err)}}return requestId}function save(requestParam,trackingSecured){var requestObj={};requestObj[CONST_REQUEST_PARAM]=requestParam;requestObj[CONST_REQUEST_TIME]=new Date().getTime();requestObj[CONST_RETRY_COUNT]=1;requestObj[CONST_TRACKING_SECURED]=trackingSecured;eventStorage[requestParam[CONST_REQUEST_ID]]=requestObj;SN.Logger.consoleLog("SN.Tracker: Successfully saved the request, req id = "+requestParam[CONST_REQUEST_ID])}function getDefaultUrl(trackingSecured){if(!SN.Utils.undefinedOrNull(trackingSecured)&&trackingSecured){return"https://"+SN.Conf.PSP_ROOT+"/psp/"+SN.Conf.CONST_PSP_KEY+"/"+SN.Conf.CONST_PSP_VERSION+"/pxt.js?"}return document.location.protocol+"//"+SN.Conf.PSP_ROOT+"/psp/"+SN.Conf.CONST_PSP_KEY+"/"+SN.Conf.CONST_PSP_VERSION+"/pxt.js?"}function createTrackingData(eventData){var trackingData={};trackingData.e=eventData;var trackigDataJSON=JSON_247.stringify(trackingData);var trackingDatas=[];for(var i=0;i<trackigDataJSON.length;i=i+MAX_URL_SIZE){var end=i+MAX_URL_SIZE;if(trackigDataJSON.length<=i+MAX_URL_SIZE){end=trackigDataJSON.length}trackingDatas.push(trackigDataJSON.substring(i,end))}return trackingDatas}function isIE(){if(navigator.userAgent.indexOf(CONST_IE)!=-1){return true}return false}function isSafari(){if(navigator.userAgent.indexOf(CONST_SAFARI)!=-1){return true}return false}function evaluate(inputExp){var result={};for(var property in inputExp){try{var value=eval(inputExp[property]);if((value!=null)&&(value!=SN_CONSTANTS.UNDEFINED_STR)&&(value!="null")){result[property]=eval(inputExp[property])}}catch(err){SN.Logger.consoleLog("PS: error in getting value for: "+property+" "+err)}}return result}function getBSID(){var SN_CONSTANTS=SN.Constants;var bsid;try{bsid=SN.CookieManager.readSNCookie(SN_CONSTANTS.SN_BS_COOKIE_NAME,"bsid");if(SN.Utils.undefinedOrNull(bsid)){bsid=getUniqueId();SN.Logger.consoleLog("Creating new BSID: value = "+bsid);SN.CookieManager.createSNCookie(SN_CONSTANTS.SN_BS_COOKIE_NAME,"bsid",bsid)}}catch(err){SN.Logger.consoleLog("BSID Cookie read/write failed  "+err)}return bsid}function getUniqueId(){return Math.random().toString().substring(2,18)+"-"+new Date().getTime()}function getUniquePageId(){return uniquePageId}function appendUrlParams(url,scriptId,params){var appendAmpersand=(url.length>0)&&(url.charAt(url.length-1)!="?");if(appendAmpersand==true){url+="&"}else{appendAmpersand=true}url+="sId="+scriptId;for(var property in params){if(appendAmpersand==true){url+="&"}else{appendAmpersand=true}if(typeof params[property]==="object"){url+=(property+"="+encodeURIComponent(JSON_247.stringify(params[property])))}else{url+=(property+"="+encodeURIComponent(params[property]))}}return url}function copyParams(source,destination){if(SN.Utils.undefinedOrNull(source)){return}for(var key in source){if(!SN.Utils.undefinedOrNull(source[key])){destination[key]=source[key]}}}function retrieveEventRequestId(eventRequestId){var requestIds=eventRequestId.split("-");return requestIds[0]+"-"+requestIds[1]}function updateStatus(requestId,statusFlag){try{var eventRequestId=retrieveEventRequestId(requestId);if(SN.Utils.undefinedOrNull(status[eventRequestId])){return}if(!SN.Utils.undefinedOrNull(statusFlag)){if(!SN.Utils.undefinedOrNull(statusTracker)){statusTracker.call(this,eventRequestId,statusFlag)}delete status[eventRequestId];return}status[eventRequestId]=status[eventRequestId]-1;if(status[eventRequestId]==0){if(!SN.Utils.undefinedOrNull(statusTracker)){statusTracker.call(this,eventRequestId,"SUCCESS")}delete status[eventRequestId]}}catch(err){SN.Logger.consoleLog("SN.Tracker: Error while updating the status for request id ="+requestId+" "+err)}}function setWowpxSessionData(visitorGroup,targetPopulation,targetId,uniquePageId,randomNumberForTargetPopulation,randomNumberForVisitorGroup){if(!SN.Utils.undefinedOrNull(visitorGroup)&&!SN.Utils.undefinedOrNull(targetPopulation)&&!SN.Utils.undefinedOrNull(targetId)){vg=visitorGroup;tp=targetPopulation;ti=targetId}if(!SN.Utils.undefinedOrNull(uniquePageId)){uniquePageId="wowpx_"+uniquePageId}if(!SN.Utils.undefinedOrNull(randomNumberForTargetPopulation)&&!SN.Utils.undefinedOrNull(randomNumberForVisitorGroup)){rt=randomNumberForTargetPopulation;rv=randomNumberForVisitorGroup}}init();return{constructAndMakeTrackingCall:constructAndMakeTrackingCall,processResponse:processResponse,removeElement:removeElement,getUniquePageId:getUniquePageId,setWowpxSessionData:setWowpxSessionData}}());SN.Custom=SN.Custom||{};SN.Custom.XdDataHandler=function(f){var i="wowpxstatechangeevent";var g="wowpxtrackingevent";var d="trackingEvent";var a="customEvent";var h={};if(f.data==null||typeof f.data=="undefined"){f.data={}}f.data.force=true;var b="sn_iframe";var e=document.getElementById(b);if(e){var c=e.contentWindow||e.contentDocument;if(c&&c.SN&&c.SN.EventManager){if(f.eventType==d){c.SN.EventManager.fire(g,{sr:f.source,eventId:f.eventId,x:f.ex,agentId:f.agentId,formId:f.formId,fireImmediately:true,data:f.data})}else{if(f.eventType==a){c.SN.EventManager.fire(i,{sr:f.source,eventId:f.eventId,x:f.ex,agentId:f.agentId,formId:f.formId,fireImmediately:true,data:f.data})}}}}};XD=(function(){var b={};function d(e,g){var f=b[e]||null;b[e]=g;return f}function c(f,e){var g=b[f];if(g){g(e)}}function a(){if(typeof console!="undefined"){console.error(arguments)}}return{registerListener:d,process:c}})();XD.registerListener("https://d1af033869koo7.cloudfront.net",SN.Custom.XdDataHandler);XD.registerListener("http://d1af033869koo7.cloudfront.net",SN.Custom.XdDataHandler);if(typeof SN==="undefined"){SN={}}(function loadSpacerImage(){var a=new Image();a.style.display="none";var d=SN.Conf.CONST_PSP_ROOT;a.src="https://"+d+"/spacer.gif";try{var b=document.getElementsByTagName("head").item(0);void (b.appendChild(a))}catch(c){if(typeof console!=undefined){SN.Logger.consoleLog("Error while loading image "+c)}}})();try{var randStr=(new String(new Date().getTime())).valueOf()+"-"+(Math.floor(Math.random()*1000000));window.pspSNTrackingId=randStr}catch(err){if(typeof console!=undefined){SN.Logger.consoleLog("Error: Unable to generate unique id for custom events "+err)}}SN.Tag=(function(){var g="iframe";var c="sn_iframe";var a="0px";var l="0px";var b="0px";var j="absolute";var n="-50px";var k="-50px";var h=null;var d=document.domain;var m="";function f(p,o){var r=document.createElement(g);r.style.width=a;r.style.height=l;r.style.border=b;r.style.position=j;r.style.top=k;r.style.left=n;r.async=true;r.id=c;if(SN.Conf.DOMAIN_VS_PARAMETIZED_PATH_AND_EXTENSION!=null&&(SN.Conf.DOMAIN_VS_PARAMETIZED_PATH_AND_EXTENSION[d]!=undefined)&&(SN.Conf.DOMAIN_VS_PARAMETIZED_PATH_AND_EXTENSION[d]!=null)){m=SN.Conf.DOMAIN_VS_PARAMETIZED_PATH_AND_EXTENSION[d]}else{SN.loadTrackingScript("CouldntDeterminePathAndExtensionFor247SN","","",SN.Conf.CUSTOM_TRACK_SERVER,SN.Conf.CONST_PSP_KEY,SN.Constants.LOGLEVEL_ERROR);return}r.src=m+"#key="+SN.Conf.CONST_PSP_KEY+"&documentDomain="+d+"&version="+p+"&pspVersion="+o+"&cdnPath="+SN.Conf.CDN_DOMAIN+"&r="+SN.Conf.CONST_PXFWK_ID;var q=document.getElementsByTagName("script")[0];q.parentNode.insertBefore(r,q)}function e(){if(!SN.Utils.undefinedOrNull(h)){return h=="true"}if(window.localStorage){h=window.localStorage.getItem(SN.Constants.IS_CUSTOM_TRACKING_ENABLED)}else{h=SN.CookieManager.readSNCookie(SN.Constants.SN_BS_COOKIE_NAME,SN.Constants.IS_CUSTOM_TRACKING_ENABLED)}if(SN.Utils.undefinedOrNull(h)){if((Math.floor(Math.random()*(100)))<=SN.Conf.CUSTOM_TRACKING_PERCENTAGE){h="true"}else{h="false"}if(window.localStorage){window.localStorage.setItem(SN.Constants.IS_CUSTOM_TRACKING_ENABLED,h)}else{SN.CookieManager.createSNCookie(SN.Constants.SN_BS_COOKIE_NAME,SN.Constants.IS_CUSTOM_TRACKING_ENABLED,h)}}return h=="true"}if(e()){SN.loadTrackingScript("247pxLoading","","",SN.Conf.CUSTOM_TRACK_SERVER,SN.Conf.CONST_PSP_KEY,SN.Constants.LOGLEVEL_INFO)}e();var i={createSNIframeOnHead:f};return i})();if(typeof SN==="undefined"){SN={}}SN.ResourceLoader=(function(){var g="sn.bs";var t="d";var i="pv";var b="a";var c="b";var k="cv";var r=null;var e="Windows";var u="MacOS";var E="default";var D=null;var y="e";var n="bd";var p="bl";var f="si";var l="ce";var C="ec";var v="rf";var A="500001";var j="ENVNOTSUPPORTED";var w="es";var h="n";var z={t:"test",d:"default"};var G=SN.Logger;function m(){if(typeof r=="undefined"||SN.Utils.undefinedOrNull(r)){G.consoleLog("sn.cookie exists but decision doesn't exist in cookie, getting decision !!");o()}else{if(r==b){if(typeof E=="undefined"||SN.Utils.undefinedOrNull(E)||typeof D=="undefined"||SN.Utils.undefinedOrNull(D)){if(typeof console!="undefined"){SN.Logger.consoleLog("sn.cookie contains decision but not pspversion or cdnversion, getting decision !!")}o()}else{SN.Tag.createSNIframeOnHead(D,z[E])}}else{G.consoleLog("Decision in sn.cookie != active, not initializing framework")}}}function o(){try{var I=Math.random().toString().substring(2,4);if(I<SN.Conf.BYPASS_PERCENTAGE){r=c}else{r=b}if(r==b){I=Math.random().toString().substring(2,4);I=parseInt(I);if(I<SN.Conf.TEST_PERCENTAGE){E="t";SN.Conf.CONST_PSP_VERSION="test"}else{E="d";SN.Conf.CONST_PSP_VERSION="default"}}D=SN.Conf.CONST_CDN_VERSION;var K={};K[i]=E;K[k]=D;K[t]=r;var H=SN.CookieManager.readSNCookie(g,"bsid");if(typeof H!=undefined&&!SN.Utils.undefinedOrNull(H)){K.bsid=H;SN.CookieManager.eraseCookie(g)}SN.CookieManager.createSNCookieForMap(g,K);m()}catch(J){G.consoleLog("Error while processing decision",J)}}function F(H){var J=H.split(".");for(var I in J){J[I]=parseInt(J[I])}return J}function q(H,K){var L=F(H);var M=F(K);var J=L.length;if(L.length>M.length){J=M.length}for(var I=0;I<J;I++){if(L[I]>M[I]){return true}else{if(L[I]<M[I]){return false}}}if(I==J){return true}}function B(){try{var J=SN.UserAgentParser;var H;for(var I in J.browserList){if(J.isBrowser(I)==true){H=J.browserList[I].getVersion();if(q(H,J.browserList[I].lowestSupportedVersion)){for(var L in J.browserList[I].blacklistedVersions){if(H==J.browserList[I].blacklistedVersions[L]){return false}}return true}else{return false}}}return false}catch(K){G.consoleLog("Error while evaluating isBrowserSupported:"+K);return false}}function d(){try{var H=SN.UserAgentParser.getOSType();if(H.indexOf(e)==-1&&H.indexOf(u)==-1&&H.indexOf("Android")==-1){return true}else{return false}}catch(I){G.consoleLog("Error while evaluating isNotOSSupported:",I);return true}}function x(H,K){var J=(H.length>0)&&(H.charAt(H.length-1)!="?");for(var I in K){if(J==true){H+="&"}else{J=true}if(typeof K[I]==="object"||(s(K))){H+=(I+"="+encodeURIComponent(JSON_247.stringify(K[I])))}else{H+=(I+"="+encodeURIComponent(K[I]))}}return H}function s(H){return(H.constructor==Array)}function a(){var N=SN.CookieManager.readSNCookie(g,w);if((typeof N!=undefined)&&(N!=null)&&N==h){SN.Logger.consoleLog("As per sn.bs cookie,env is not supported, not proceeding further.");return}if((!B())||!(navigator.cookieEnabled)||(d())){try{if(navigator.cookieEnabled){SN.CookieManager.createSNCookie(g,w,h)}var J=SN.UserAgentParser;var I={};var M={};M[f]=j;M[n]=navigator.userAgent;M[l]=navigator.cookieEnabled;M[C]=A;M[p]=J.getBrowserLanguage();M[v]=document.referrer;var H={key:SN.Conf.CONST_PSP_KEY};I[y]=M;SN.Tracker.constructAndMakeTrackingCall(H,M);return}catch(L){SN.Logger.consoleLog("Error while making a tracking call: "+L)}}if(!SN.Conf.IS_DS_REQUIRED){SN.Tag.createSNIframeOnHead(SN.Conf.CONST_CDN_VERSION,SN.Conf.PSP_VERSION);return}var K=SN.CookieManager.readCookie(g);if(typeof K==undefined||K==null){o()}else{r=SN.CookieManager.readSNCookie(g,t);E=SN.CookieManager.readSNCookie(g,i);D=SN.CookieManager.readSNCookie(g,k);m()}}a()}());